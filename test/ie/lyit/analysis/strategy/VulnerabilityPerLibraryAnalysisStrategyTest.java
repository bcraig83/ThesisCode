package ie.lyit.analysis.strategy;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNotNull;
import ie.lyit.analysis.strategy.analysisresult.VulnerabilityPerLibraryAnalysisStrategy;

import org.junit.Before;

public class VulnerabilityPerLibraryAnalysisStrategyTest extends AbstractStrategyTest {

	@Before
	public void setUp() throws Exception {
		fixture = new VulnerabilityPerLibraryAnalysisStrategy();
	}

	@Override
	protected void validateVanillaRun() {

		analysisResult = fixture.getAnalysisResult();

		countingMap = analysisResult.getCountingMap();

		assertNotNull(analysisResult);
		assertNotNull(countingMap);
		assertEquals(1, countingMap.size());
		assertEquals("Number of vulnerabilities per library", analysisResult.getNameOfAnalysis());
		assertEquals(0, analysisResult.getStringMap().size());
		assertEquals("Project name", analysisResult.getTypeOfItemOfInterest());

	}
}